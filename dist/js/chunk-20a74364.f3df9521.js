(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20a74364"],{"0f9d":function(t,s,e){},a784:function(t,s,e){"use strict";e("0f9d")},e867:function(t,s,e){"use strict";e.r(s);var i=e("62ad"),a=e("a523"),o=e("ce7e"),r=e("0fd9"),n=e("7e85"),c=e("e516"),p=e("9c54"),l=e("56a4"),d=function(){var t=this,s=t._self._c;return s(a["a"],{staticClass:"pt-0 px-0",attrs:{fluid:""}},[s(n["a"],{staticClass:"pt-0",model:{value:t.step,callback:function(s){t.step=s},expression:"step"}},[s(p["a"],[s(l["a"],{attrs:{complete:t.step>1,step:"1",editable:""}},[t._v(" Datos de la Carga ")]),s(o["a"]),s(l["a"],{attrs:{complete:t.step>2,step:"2",editable:t.editableStep2}},[t._v(" costos de la Cotización ")]),s(o["a"]),s(l["a"],{attrs:{step:"3"}},[t._v(" Comparativa ")]),s(o["a"]),s(l["a"],{attrs:{step:"4"}},[t._v(" Notas de Costos ")])],1),s(p["b"],[s(c["a"],{attrs:{step:"1"}},[s(r["a"],[s(i["a"],{staticClass:"pt-0",attrs:{cols:"12",md:"6"}},[s(r["a"],[s(i["a"],{staticClass:"my-0 py-0",attrs:{cols:"12"}},[s("DatosPrincipales",{on:{recargarServiciosCostos:t.recargar,activarDatosCarga:t.activarDatosCarga}})],1)],1)],1),s(i["a"],{staticClass:"my-0 py-0",attrs:{cols:"12",md:"6",id:"DatosCargaComponent"}},[t.DatosCargaComponentFlag?s("DatosCargaComponent",{on:{activarServicios:function(s){return t.activarServicios()},recargarCostos:t.recargarCostos}}):t._e()],1),s(i["a"],{attrs:{cols:"12",id:"ServicesComponent"}},[t.ServicesComponentFlag?s("ServicesComponent",{on:{activarLlenadoCostos:function(s){return t.activarLlenadoCostos()},recargarCostos:function(s){return t.recargarCostos()}}}):t._e()],1)],1)],1),s(c["a"],{attrs:{step:"2"}},[s("DatosCostosComponent",{key:t.indexCostos,attrs:{mostrarImpuestosEditar:!0},on:{anadirNuevaOpcion:t.anadirNuevaOpcion,continuarComparativa:t.continuarComparativa,irANotas:t.irANotas}})],1),s(c["a"],{attrs:{step:"3"}},[s("ComparativaComponent",{on:{irVentaCliente:t.irVentaCliente}})],1),s(c["a"],{attrs:{step:"4"}},[s("NotasComponent",{attrs:{editable:t.editableStep4}})],1)],1)],1)],1)},g=[],h=(e("14d9"),e("e9f5"),e("910d"),e("796d"),e("7d54"),e("ab43"),e("1e70"),e("79a4"),e("c1a1"),e("8b00"),e("a4e7"),e("1e5a"),e("72c3"),e("7047")),u=e("c384"),m=e("24f5"),C=e("93d9"),f=e("4577"),v=e("9fef"),$=e("2f62"),_=e("3d20"),P=e.n(_),S={components:{DatosPrincipales:h["a"],DatosCargaComponent:u["a"],ServicesComponent:m["a"],DatosCostosComponent:C["a"],ComparativaComponent:f["a"],NotasComponent:v["a"]},data(){return{step:1,DatosCargaComponentFlag:!1,ServicesComponentFlag:!1,editableStep2:!1,editableStep4:!1,recargarSegmentos:!1,indexCostos:0}},async mounted(){this.$store.commit("SET_RESET"),this.$store.state.mainTitle="Nueva Cotización",Promise.all([await this.getMarketingList(),await this.getQuoteStatus(),await this.getModality(),await this.getShipment(),await this.getIncoterms(),await this.getCargarEjecutivo()]);let t=[...this.$store.state.pricing.opcionCostos],s=[];t.forEach(t=>{t.listCostos.forEach(t=>{s.some(s=>s==t.id_proveedor)||s.push(t.id_proveedor)})}),Promise.all([await this.getBegEndList(),await this.getServices(),await this.obtenerCostosPricing(),await this.getImpuestos(),await this.getCargarMasterDetalleNotasCotizacion(),await this.obtenerImpuestoXEmpresa(),await this.cargarMasterDetallePercepcionAduana(),await this._getContainers()]),await this.obtenerProveedorPricing({id:s.join(","),search:null})},methods:{...Object($["b"])(["resetQuoteNew","obtenerProveedorPricing","getMarketingList","getQuoteStatus","getModality","getShipment","getIncoterms","getCargarEjecutivo","getPortBegin","getPortEnd","getServices","getBegEndList","getTipoCostos","obtenerCostosPricing","getMultiplicador","getImpuestos","getCargarMasterDetalleNotasCotizacion","cargarProveedores","obtenerImpuestoXEmpresa","registrarQuote","cargarMasterDetallePercepcionAduana","_getContainers"]),recargar(){this.$store.state.pricing.listServices.length>0&&(this.recargarServicios(),this.getTipoCostos()),this.editableStep2&&this.recargarCostos()},continuarComparativa(){this.step=3},async activarDatosCarga(){this.$store.state.spiner=!0,await this.getPortBegin({id_transport:this.$store.state.pricing.datosPrincipales.idtipocarga.id_transport?this.$store.state.pricing.datosPrincipales.idtipocarga.id_transport:this.$store.state.pricing.datosPrincipales.idtipocarga}),await this.getPortEnd({id_transport:this.$store.state.pricing.datosPrincipales.idtipocarga.id_transport?this.$store.state.pricing.datosPrincipales.idtipocarga.id_transport:this.$store.state.pricing.datosPrincipales.idtipocarga}),this.DatosCargaComponentFlag=!0,this.$nextTick(()=>{const t=document.getElementById("DatosCargaComponent");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}),this.$store.state.spiner=!1},async activarServicios(){this.ServicesComponentFlag=!0;let t=[...this.$store.state.pricing.preServices],s=t.filter(t=>t.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.pricing.datosPrincipales.idtipocarga.id);this.getTipoCostos(),this.$store.state.pricing.listServices=s,this.$nextTick(()=>{const t=document.getElementById("ServicesComponent");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}),this.$store.state.spiner=!1},recargarServicios(){let t=[...this.$store.state.pricing.preServices];if(0==t.length)return;let s=t.filter(t=>t.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.pricing.datosPrincipales.idtipocarga.id),e=s.map(t=>t.id);this.$store.state.pricing.listServices.filter(t=>!!t.id).forEach(t=>{if(!e.includes(t.id)){let s=this.$store.state.pricing.listServices.findIndex(s=>s.code_service==t.code_service);this.$store.state.pricing.listServices.splice(s,1)}}),e=this.$store.state.pricing.listServices.map(t=>t.code_service),s.forEach(t=>{e.includes(t.code_service)||this.$store.state.pricing.listServices.push(t)})},async activarLlenadoCostos(){this.$store.state.spiner=!0,await this.getMultiplicador();let t=new Set(this.$store.state.pricing.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),s=[...this.$store.state.pricing.preCostos],e=s.filter(s=>s.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&s.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&s.id_shipment==this.$store.state.pricing.datosPrincipales.idtipocarga.id&&t.has(s.code_service)),i=[];this.$store.state.pricing.datosPrincipales.containers.length>0&&(i=this.$store.state.pricing.datosPrincipales.containers.map(t=>t.id),console.log("ID de Containers:",i));let a=e.filter(t=>!t.escontenedorflag||i.includes(t.id_container)),o=[69,114,105,39],r=a.flatMap(t=>o.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45),nro_propuesta:1}]:[{...t,nro_propuesta:1,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45),nro_propuesta:1},{...t,nro_propuesta:1,esopcionflag:0,esventaflag:1,status:!0,costounitario:0,cif:0,seguro:0,nro_propuesta:1}]);this.$store.state.pricing.opcionCostos[0].listCostos=r,this.$store.state.pricing.opcionCostos[0].listImpuestos=this.$store.state.pricing.listImpuestos,this.$store.state.pricing.opcionCostos[0].listNotasQuote=this.$store.state.pricing.listNotasQuote,this.$store.state.spiner=!1,P.a.fire({icon:"question",title:"Cotizar",text:"¿Desea pasar a Cotizar?",confirmButtonText:"Pasar a Cotizar",denyButtonText:"Guardar Borrador",allowEnterKey:!1,allowOutsideClick:!1,confirmButtonColor:"green",showDenyButton:!0,allowEscapeKey:!1}).then(async t=>{t.isConfirmed&&(this.step=2,this.editableStep2=!0),t.isDenied&&await this.guardar()})},async guardar(){if(this.$store.state.spiner=!0,this.$store.state.pricing.opcionCostos[0].selected=!0,await this.registrarQuote({fullflag:!1}).catch(t=>{console.log("registrarQuote",t)}),this.$store.state.pricing.nro_quote){this.$store.state.spiner=!1;let t=this;P.a.fire({icon:"success",title:"Aviso",text:t.$store.state.pricing.mensaje,confirmButtonText:"Ir al listado",showConfirmButton:!0}).then(s=>{s.isConfirmed&&t.$router.push({name:"lstQuote"}),s.isDismissed&&t.$router.push({name:"lstQuote"})});let s=JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch,e=[1,2];e.includes(s)&&(await this.crearCarpetaOneDrive({nro_quote:this.$store.state.pricing.nro_quote,nombre:this.$store.state.pricing.datosPrincipales.nombre}).catch(t=>{console.log("crearCarpetaOneDrive",t)}),await this.actualizarURLEnElQuote({id:this.$store.state.pricing.id,url:this.$store.state.pricing.urlFolder}).catch(t=>{console.log("actualizarURLEnElQuote",t)}))}},anadirNuevaOpcion(t){let s=new Set(this.$store.state.pricing.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),e=[...this.$store.state.pricing.preCostos],i=e.filter(t=>t.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.pricing.datosPrincipales.idtipocarga.id&&s.has(t.code_service)),a=[];this.$store.state.pricing.datosPrincipales.containers.length>0&&(a=this.$store.state.pricing.datosPrincipales.containers.map(t=>t.id),console.log("ID de Containers:",a));let o=i.filter(t=>!t.escontenedorflag||a.includes(t.id_container)),r=[69,114,105,39],n=o.flatMap(s=>r.includes(s.code_cost)?[{...s,esopcionflag:1,nro_propuesta:t,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...s,esopcionflag:1,nro_propuesta:t,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...s,esopcionflag:0,nro_propuesta:t,esventaflag:1,status:!0,cif:0,seguro:0,costounitario:0}]),c={nro_propuesta:t,date_end:"",tiempo_transito:0,listCostos:n,listImpuestos:this.$store.state.pricing.listImpuestos,listNotasQuote:this.$store.state.pricing.listNotasQuote};this.$store.state.pricing.opcionCostos.push(c),this.$store.state.spiner=!1},async recargarCostos(){await this.getTipoCostos(),await this.getMultiplicador();let t=new Set(this.$store.state.pricing.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),s=this.$store.state.pricing.preCostos.filter(s=>s.id_incoterms===this.$store.state.pricing.datosPrincipales.idincoterms&&s.id_modality===this.$store.state.pricing.datosPrincipales.idsentido&&s.id_shipment===this.$store.state.pricing.datosPrincipales.idtipocarga.id&&t.has(s.code_service)),e=[];this.$store.state.pricing.datosPrincipales.containers.length>0&&(e=this.$store.state.pricing.datosPrincipales.containers.map(t=>t.id));let i=s.filter(t=>!t.escontenedorflag||e.includes(t.id_container)),a=[69,114,105,39],o=i.flatMap(t=>a.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,nro_propuesta:1,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,nro_propuesta:1,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:!0,cif:0,seguro:0,costounitario:0}]);this.$store.state.pricing.opcionCostos=this.$store.state.pricing.opcionCostos.slice(0,1),this.$store.state.pricing.index=0,this.$store.state.pricing.opcionCostos[0].listCostos=o,this.$store.state.pricing.opcionCostos[0].listImpuestos=this.$store.state.pricing.listImpuestos,this.$store.state.pricing.opcionCostos[0].listNotasQuote=this.$store.state.pricing.listNotasQuote,this.$store.state.pricing.llenadoCostos=!0,this.$forceUpdate(),this.indexCostos++},irVentaCliente(){this.step=2},irANotas(){this.step=4,this.editableStep4=!0,this.$store.state.pricing.btnRegistrar=!0}},computed:{}},w=S,b=(e("a784"),e("2877")),D=Object(b["a"])(w,d,g,!1,null,"3cdcf944",null);s["default"]=D.exports}}]);