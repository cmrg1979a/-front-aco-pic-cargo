(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bac2d"],{"391b":function(t,e,a){"use strict";a.r(e);var i=a("8336"),s=a("b0af"),r=a("99d9"),n=a("62ad"),o=a("a523"),l=a("8fea"),c=a("4bd4"),d=a("132d"),u=a("da13"),m=a("5d23"),h=a("f774"),g=a("8e36"),p=a("67b6"),k=a("43a6"),w=a("0fd9"),v=a("2fa4"),b=a("b73d"),f=a("8654"),_=function(){var t=this,e=t._self._c;return e(s["a"],{staticClass:"px-5",attrs:{fluid:""}},[e(s["a"],{attrs:{elevation:"0"}},[t.loading?e(o["a"],{staticStyle:{height:"400px"}},[e(w["a"],{staticClass:"fill-height",attrs:{"align-content":"center",justify:"center"}},[e(n["a"],{staticClass:"text-subtitle-1 text-center",attrs:{cols:"12"}},[t._v(" Cargando información .... ")]),e(n["a"],{attrs:{cols:"6"}},[e(g["a"],{attrs:{color:"deep-purple accent-4",indeterminate:"",rounded:"",height:"6"}})],1)],1)],1):t._e(),t.loading?t._e():e(r["d"],{staticClass:"elevation-0"},[e(f["a"],{attrs:{"append-icon":"mdi-magnify",label:"Buscar","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e(v["a"]),e(i["a"],{attrs:{small:"",color:"success"},on:{click:function(e){return t.open_insert()}}},[t._v(" Nuevo ")]),e(i["a"],{staticClass:"mx-1",attrs:{small:"",color:"#2962FF",dark:""},on:{click:function(e){return t.open_filter()}}},[t._v(" Filtrar ")]),e(i["a"],{staticClass:"mx-1",attrs:{small:"",color:"#004D40",dark:""}},[t._v(" Exportar ")])],1),t.loading?t._e():e(l["a"],{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.$store.state.marketing.list,"item-key":"id",search:t.search},scopedSlots:t._u([{key:"item.status",fn:function({item:e}){return[t._v(" "+t._s(e.status?"Activo":"Inactivo")+" ")]}},{key:"item.action",fn:function({item:a}){return[e(i["a"],{attrs:{icon:""}},[e(d["a"],{attrs:{color:"primary"},on:{click:function(e){return t.open_read(a.id)}}},[t._v("mdi-eye")])],1),e(i["a"],{attrs:{icon:""}},[e(d["a"],{attrs:{color:"warning"},on:{click:function(e){return t.open_update(a.id)}}},[t._v("mdi-pencil")])],1),a.status?e(i["a"],{attrs:{icon:"",color:"red"},on:{click:function(e){return t.switch_status(a)}}},[e(d["a"],[t._v("mdi-delete")])],1):t._e()]}}],null,!0)})],1),e(h["a"],{attrs:{absolute:"",bottom:"",temporary:"",right:"",width:"30%",height:"100vh"},model:{value:t.showFilterDrawerUpdate,callback:function(e){t.showFilterDrawerUpdate=e},expression:"showFilterDrawerUpdate"}},[t.loading_as?t._e():e(o["a"],[e(u["a"],{staticClass:"px-0"},[e(m["a"],[e(m["c"],{staticClass:"text-h6"},[t._v(" Modificar: "+t._s(t.$store.state.marketing.record.name)+" ")])],1)],1),e(v["a"]),e(r["c"],[e(w["a"],[e(f["a"],{attrs:{label:"Código",readonly:"",value:t.$store.state.marketing.record.code}})],1),e(c["a"],{ref:"form"},[e(w["a"],[e(f["a"],{attrs:{type:"text",label:"Nombre (*)",clearable:"",rules:[e=>t.validateName(e)],"lazy-validation":""},model:{value:t.marketing.name,callback:function(e){t.$set(t.marketing,"name",e)},expression:"marketing.name"}})],1),e(w["a"],[e(f["a"],{attrs:{type:"text",label:"Descripción",clearable:"",rules:[e=>t.validateDescription(e)],"lazy-validation":""},model:{value:t.marketing.description,callback:function(e){t.$set(t.marketing,"description",e)},expression:"marketing.description"}})],1)],1),e(w["a"],[e(f["a"],{attrs:{type:"number",label:"Posición (*)",rules:[e=>t.validatePosition(e)],"lazy-validation":"","error-messages":t.errorPosition,clearable:""},on:{blur:t.validateEditarPositionAPI},model:{value:t.marketing.position,callback:function(e){t.$set(t.marketing,"position",e)},expression:"marketing.position"}})],1),e(w["a"],[e(b["a"],{attrs:{label:"Estado: "+(t.marketing.status?"Activo":"Inactivo"),color:"success"},on:{change:t.updateStatus},model:{value:t.marketing.status,callback:function(e){t.$set(t.marketing,"status",e)},expression:"marketing.status"}})],1)],1),e(r["a"],{staticClass:"justify-end mt-3"},[e(i["a"],{staticClass:"mx-1",attrs:{color:"success"},on:{click:function(e){return t.submit_update()}}},[t._v(" Aceptar")]),e(i["a"],{staticClass:"mx-1",attrs:{dark:"",color:"warning"},on:{click:function(e){t.showFilterDrawerUpdate=!t.showFilterDrawerUpdate}}},[t._v(" Cerrar")])],1)],1),t.loading_as?e(o["a"],{staticStyle:{height:"400px"}},[e(w["a"],{staticClass:"fill-height",attrs:{"align-content":"center",justify:"center"}},[e(n["a"],{staticClass:"text-subtitle-1 text-center",attrs:{cols:"12"}},[t._v(" Cargando información .... ")]),e(n["a"],{attrs:{cols:"6"}},[e(g["a"],{attrs:{color:"deep-purple accent-4",indeterminate:"",rounded:"",height:"6"}})],1)],1)],1):t._e()],1),e(h["a"],{attrs:{absolute:"",bottom:"",temporary:"",right:"",width:"30%",height:"100vh"},model:{value:t.showFilterDrawerRead,callback:function(e){t.showFilterDrawerRead=e},expression:"showFilterDrawerRead"}},[t.loading_as?t._e():e(o["a"],[e(u["a"],{staticClass:"px-0"},[e(m["a"],[e(m["c"],{staticClass:"text-h6"},[t._v(" Ver: "+t._s(t.$store.state.marketing.record.name)+" ")])],1)],1),e(v["a"]),e(r["c"],[e(w["a"],[e(f["a"],{attrs:{label:"Código",readonly:"",value:t.$store.state.marketing.record.code}})],1),e(w["a"],[e(f["a"],{attrs:{label:"Nombre",readonly:"",value:t.$store.state.marketing.record.name}})],1),e(w["a"],[e(f["a"],{attrs:{label:"Descripción",readonly:"",value:t.$store.state.marketing.record.description}})],1),e(w["a"],[e(f["a"],{attrs:{label:"Posición",readonly:"",value:t.$store.state.marketing.record.position}})],1),e(w["a"],[e(b["a"],{attrs:{readonly:"",label:"Estado: "+(t.$store.state.marketing.record.status?"Activo":"Inactivo"),color:"success"},model:{value:t.$store.state.marketing.record.status,callback:function(e){t.$set(t.$store.state.marketing.record,"status",e)},expression:"$store.state.marketing.record.status"}})],1)],1),e(r["a"],{staticClass:"justify-end mt-3"},[e(i["a"],{staticClass:"mx-1",attrs:{dark:"",color:"warning"},on:{click:function(e){t.showFilterDrawerRead=!t.showFilterDrawerRead}}},[t._v(" Cerrar")])],1)],1),t.loading_as?e(o["a"],{staticStyle:{height:"400px"}},[e(w["a"],{staticClass:"fill-height",attrs:{"align-content":"center",justify:"center"}},[e(n["a"],{staticClass:"text-subtitle-1 text-center",attrs:{cols:"12"}},[t._v(" Cargando información .... ")]),e(n["a"],{attrs:{cols:"6"}},[e(g["a"],{attrs:{color:"deep-purple accent-4",indeterminate:"",rounded:"",height:"6"}})],1)],1)],1):t._e()],1),e(h["a"],{attrs:{absolute:"",bottom:"",temporary:"",right:"",width:"30%",height:"100vh"},model:{value:t.showFilterDrawer,callback:function(e){t.showFilterDrawer=e},expression:"showFilterDrawer"}},[e(u["a"],[e(m["a"],[e(m["c"],{staticClass:"text-h6"},[t._v(" Filtrar Registros ")])],1)],1),e(v["a"]),e(o["a"],[e(r["c"],[e(w["a"],[e(f["a"],{attrs:{type:"text",label:"Nombre",clearable:""},model:{value:t.marketing_list.name,callback:function(e){t.$set(t.marketing_list,"name",e)},expression:"marketing_list.name"}})],1),e(w["a"],[e(f["a"],{attrs:{label:"Descripción",clearable:""},model:{value:t.marketing_list.description,callback:function(e){t.$set(t.marketing_list,"description",e)},expression:"marketing_list.description"}})],1),e(w["a"],[e(f["a"],{attrs:{type:"number",label:"Posición",clearable:""},model:{value:t.marketing_list.position,callback:function(e){t.$set(t.marketing_list,"position",e)},expression:"marketing_list.position"}})],1),e(w["a"],[e(k["a"],{attrs:{row:"",dense:""},model:{value:t.marketing_list.status,callback:function(e){t.$set(t.marketing_list,"status",e)},expression:"marketing_list.status"}},[e(p["a"],{attrs:{label:"Activo",color:"green",value:1}}),e(p["a"],{attrs:{label:"Inactivo",color:"red",value:0}}),e(p["a"],{attrs:{label:"Todos",color:"blue",value:"null"}})],1)],1)],1),e(r["a"],{staticClass:"justify-end mt-3"},[e(i["a"],{staticClass:"mx-1",attrs:{color:"success"},on:{click:function(e){return t.filtar()}}},[t._v(" Aceptar")]),e(i["a"],{staticClass:"mx-1",attrs:{color:"ligth"},on:{click:function(e){return t.clear("filter")}}},[t._v(" Limpiar")]),e(i["a"],{staticClass:"mx-1",attrs:{dark:"",color:"warning"},on:{click:function(e){t.showFilterDrawer=!t.showFilterDrawer}}},[t._v(" Cerrar")])],1)],1)],1),e(h["a"],{attrs:{absolute:"",bottom:"",temporary:"",right:"",width:"30%",height:"100vh"},model:{value:t.showFilterDrawerNew,callback:function(e){t.showFilterDrawerNew=e},expression:"showFilterDrawerNew"}},[e(u["a"],[e(m["a"],[e(m["c"],{staticClass:"text-h6"},[t._v(" Nuevo Tipo de Marketing ")])],1)],1),e(v["a"]),t.loading_as?t._e():e(o["a"],[e(r["c"],[e(c["a"],{ref:"formNew"},[e(w["a"],[e(f["a"],{attrs:{type:"text",label:"Nombre (*)",rules:[e=>t.validateName(e)],"lazy-validation":"",clearable:""},model:{value:t.marketing.name,callback:function(e){t.$set(t.marketing,"name",e)},expression:"marketing.name"}})],1),e(w["a"],[e(f["a"],{attrs:{type:"text",label:"Descripción",rules:[e=>t.validateDescription(e)],"lazy-validation":"",clearable:""},model:{value:t.marketing.description,callback:function(e){t.$set(t.marketing,"description",e)},expression:"marketing.description"}})],1),e(w["a"],[e(f["a"],{attrs:{type:"number",min:"1",label:"Posición (*)",rules:[e=>t.validatePosition(e)],"lazy-validation":"",clearable:"","error-messages":t.errorPosition},on:{blur:t.validateNuevoPositionAPI},model:{value:t.marketing.position,callback:function(e){t.$set(t.marketing,"position",e)},expression:"marketing.position"}})],1)],1),e(w["a"],[e(b["a"],{attrs:{dense:"",label:"Estado: "+(t.marketing.status?"Activo":"Inactivo"),"hide-details":"",color:"success"},on:{change:t.updateStatus},model:{value:t.marketing.status,callback:function(e){t.$set(t.marketing,"status",e)},expression:"marketing.status"}})],1)],1),e(r["a"],{staticClass:"justify-end mt-3"},[e(i["a"],{staticClass:"mx-1",attrs:{color:"success"},on:{click:function(e){return t.submit_insert()}}},[t._v(" Aceptar")]),e(i["a"],{staticClass:"mx-1",attrs:{dark:"",color:"warning"},on:{click:function(e){t.showFilterDrawerNew=!t.showFilterDrawerNew}}},[t._v(" Cerrar")])],1)],1),t.loading_as?e(o["a"],{staticStyle:{height:"400px"}},[e(w["a"],{staticClass:"fill-height",attrs:{"align-content":"center",justify:"center"}},[e(n["a"],{staticClass:"text-subtitle-1 text-center",attrs:{cols:"12"}},[t._v(" Cargando información .... ")]),e(n["a"],{attrs:{cols:"6"}},[e(g["a"],{attrs:{color:"deep-purple accent-4",indeterminate:"",rounded:"",height:"6"}})],1)],1)],1):t._e()],1)],1)},x=[],y=(a("e9f5"),a("7d54"),a("2f62")),C=a("3d20"),D=a.n(C),F=a("bc3a"),$=a.n(F),P={name:"ListMarketingComponent",data(){return{headers:[{text:"Código",align:"start",value:"code"},{text:"Nombre",value:"name"},{text:"Descripción",value:"description"},{text:"Posición (Orden)",value:"position"},{text:"Estado",value:"status"},{text:"Creación",value:"created_at"},{text:"Última Actualización",value:"updated_at"},{text:"Acciones",value:"action"}],dataList:!1,item:"",showFilterDrawer:!1,showFilterDrawerNew:!1,showFilterDrawerRead:!1,showFilterDrawerUpdate:!1,search:"",status:!0,marketing_list:{name:"",description:"",position:"",status:1},marketing:{id:"",id_branch:JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch,name:"",description:"",position:"",status:1},loading:!0,loading_as:!0,originalMarkting:{},originalMarktingList:{},drawer:!1,errorPosition:null,response_filter:null}},created(){this.originalMarkting={...this.marketing},this.originalMarktingList={...this.marketing_list}},async mounted(){await this.fetchDataMarketing(this.marketing_list),this.$store.state.mainTitle="Tipo de Marketing"},methods:{...Object(y["b"])(["fetchDataMarketing","insertMarketing","lastPositionMarketing","readMarketing","updateMarketing"]),updateStatus(t){this.marketing.status=t?1:0},open_insert(){this.loading_as=!0,this.errorPosition=null,this.resetMarketing(),this.resetForms(),this.lastPositionMarketing(),this.showFilterDrawerNew=!this.showFilterDrawerNew},submit_insert(){this.validateNuevoPositionAPI(),setTimeout(async()=>{this.$refs.formNew.validate()&&null==this.errorPosition&&(this.clear("filter"),await this.insertMarketing(this.marketing))},500)},async open_read(t){this.loading_as=!0,this.showFilterDrawerRead=!this.showFilterDrawerRead,await this.readMarketing(t)},async filtar(){let t={...this.marketing_list};t.status="null"==t.status?"":t.status,null===t.name&&(t.name=""),null===t.position&&(t.position=""),null===t.description&&(t.description=""),await this.fetchDataMarketing(t),this.showFilterDrawer=!1},async open_update(t){this.loading_as=!0,this.errorPosition=null,this.resetForms(),await this.readMarketing(t),this.showFilterDrawerUpdate=!this.showFilterDrawerUpdate,this.marketing.id=t},submit_update(){this.validateEditarPositionAPI(),setTimeout(async()=>{this.$refs.form.validate()&&null==this.errorPosition&&(this.clear("filter"),await this.updateMarketing(this.marketing))},500)},object_to_update(t,e){const a=Object.keys(e);a.forEach(a=>{e[a]=t[a],e["id_branch"]=JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch})},async switch_status(t){D.a.fire({title:"¿Estás seguro?",text:"Si inactiva el registro, éste no aparecerá disponible en otros formularios ¿Está seguro de que desea inactivarlo?",confirmButtonColor:"red",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, inactivar",cancelButtonColor:"orange",cancelButtonText:"Cancelar"}).then(async e=>{e.isConfirmed&&(t.status=0,this.clear("filter"),await this.updateMarketing(t))})},async validateNuevoPositionAPI(){var t={method:"get",url:"https://api.agentedecargaonline.com/validar_nuevo_posicion_marketing?id_branch="+JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch+"&position="+this.marketing.position,headers:{"Content-Type":"application/json","auth-token":sessionStorage.getItem("auth-token")}};await $()(t).then(t=>{let e=t.data;this.errorPosition=e.estadoflag?null:e.mensaje,e.estadoflag||(this.marketing.position="")}).catch(t=>{console.log("Error al obtener los datos:",t)})},async validateEditarPositionAPI(){var t={method:"get",url:"https://api.agentedecargaonline.com/validar_editar_posicion_marketing?id="+this.marketing.id+"&id_branch="+JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch+"&position="+this.marketing.position,headers:{"Content-Type":"application/json","auth-token":sessionStorage.getItem("auth-token")}};await $()(t).then(t=>{let e=t.data;this.errorPosition=e.estadoflag?null:e.mensaje,e.estadoflag||(this.marketing.position="")}).catch(t=>{console.log("Error al obtener los datos:",t)})},resetMarketing(){Object.assign(this.marketing,this.originalMarkting),Object.assign(this.marketing_list,this.originalMarktingList)},open_filter(){this.showFilterDrawer=!this.showFilterDrawer},validateName(t){let e=150;return t?!(t.length>e)||`El nombre debe tener un máximo de ${e} caracteres`:"El nombre es requerido"},validateDescription(t){let e=455;return!t||(!(t.length>e)||`La descripción debe tener un máximo de ${e} caracteres`)},validatePosition(t){return!!t||"La posición es requerida"},async clear(t){"filter"==t?this.marketing_list={...this.originalMarkting}:this.marketing={...this.originalMarktingList},await this.fetchDataMarketing(this.marketing_list),this.showFilterDrawer=!1},resetForms(){this.$refs.formNew&&this.$refs.formNew.reset(),this.$refs.form&&this.$refs.form.reset()},async reset_records(){this.clear("filter"),this.filtar()}},watch:{"$store.state.marketing.record":{handler(t,e){if(t&&Object.keys(t).length>0){const{id:e,name:a,description:i,position:s,status:r}=t;this.marketing={id:e,name:a,description:i,position:s,status:r},this.loading_as=!1}},immediate:!0},"$store.state.marketing.loading":{handler(t,e){this.loading=1!=t},immediate:!0},showFilterDrawerNew:{handler(t,e){t&&this.resetMarketing()},immediate:!0},"$store.state.marketing.last_position":{handler(t,e){t&&Object.keys(t).length>0&&t.maxposition>0&&(this.marketing.position=t.maxposition,this.loading_as=!1)},immediate:!0}}},N=P,M=a("2877"),j=Object(M["a"])(N,_,x,!1,null,null,null);e["default"]=j.exports}}]);