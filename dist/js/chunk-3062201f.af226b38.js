(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3062201f"],{"0e8f":function(t,e,a){"use strict";a("20f6");var o=a("e8f2");e["a"]=Object(o["a"])("flex")},"6e53":function(t,e,a){"use strict";a.r(e);var o=a("c6a6"),r=a("8336"),s=a("b0af"),i=a("62ad"),n=a("8fea"),l=a("23a7"),c=a("0e8f"),d=a("132d"),u=a("0fd9"),m=a("b974"),p=a("71a3"),h=a("c671"),b=a("fe57"),f=a("8654"),g=function(){var t=this,e=t._self._c;return e(s["a"],{staticClass:"pb-5",attrs:{elevation:"10"}},[e(i["a"],{attrs:{md:"12",cols:"12"}},[e("h1",[t._v("MONTO A COBRAR :"+t._s(t.symbol)+" "+t._s(t.getMontoTotal()))])]),e(b["a"],{attrs:{color:"#A43542","slider-color":"primary","fixed-tabs":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[e(p["a"],{attrs:{href:"#ref1"}},[t._v("STEP 1")]),e(p["a"],{attrs:{href:"#ref2"}},[t._v("STEP 2")]),e(h["a"],{staticClass:"px-5",attrs:{value:"ref1"}},[e(u["a"],{staticClass:"mt-5"},[e(i["a"],{attrs:{md:"4",cols:"4"}},[e(o["a"],{attrs:{items:t.clientes,"item-text":"namelong","item-value":"id",label:"Cliente",readonly:""},on:{change:function(e){return t.obtenerListado()}},model:{value:t.$store.state.bank.record.id_cliente,callback:function(e){t.$set(t.$store.state.bank.record,"id_cliente",e)},expression:"$store.state.bank.record.id_cliente"}})],1),e(i["a"],{attrs:{md:"12",cols:"12"}},[e(n["a"],{attrs:{headers:t.headers,items:t.$store.state.bank.record.details},scopedSlots:t._u([{key:"item.moneda",fn:function({item:a}){return[e(o["a"],{attrs:{items:t.$store.state.itemsCoinsList,"item-text":"acronym","item-value":"id",label:"Moneda"},on:{blur:function(e){return t.obtenerSymbol()}},model:{value:t.id_coins,callback:function(e){t.id_coins=e},expression:"id_coins"}})]}},{key:"item.montodolar",fn:function({item:a}){return[e(f["a"],{attrs:{prefix:t.symbol,type:"number",max:a.montodolar,"error-messages":a.err},on:{blur:function(e){return t.calcularTotal()}},nativeOn:{focus:function(e){return t.calcularTotal()}},model:{value:a.montodolar,callback:function(e){t.$set(a,"montodolar",e)},expression:"item.montodolar"}})]}},{key:"item.montopagar",fn:function({item:a}){return[e(f["a"],{attrs:{prefix:t.symbol,type:"number",max:a.montopagar,"error-messages":a.err},on:{blur:function(e){return t.calcularTotal()}},nativeOn:{focus:function(e){return t.calcularTotal()}},model:{value:a.montopagar,callback:function(e){t.$set(a,"montopagar",e)},expression:"item.montopagar"}})]}},{key:"item.monto_destino",fn:function({item:a}){return[e(f["a"],{attrs:{type:"number",max:a.monto_destino,"error-messages":a.err},on:{blur:function(e){return t.calcularTotal()}},nativeOn:{focus:function(e){return t.calcularTotal()}},model:{value:a.monto_destino,callback:function(e){t.$set(a,"monto_destino",e)},expression:"item.monto_destino"}})]}},{key:"item.tipocambio",fn:function({item:a}){return[e(f["a"],{attrs:{type:"number"},on:{blur:function(e){return t.calcularMonto()}},nativeOn:{focus:function(e){return t.calcularMonto()}},model:{value:a.tipocambio,callback:function(e){t.$set(a,"tipocambio",e)},expression:"item.tipocambio"}})]}},{key:"item.action",fn:function({item:a}){return[e(r["a"],{attrs:{icon:""}},[e(d["a"],{attrs:{color:"red"},on:{click:function(e){return t.anularCobro(a)}}},[t._v("mdi-circle-off-outline")])],1)]}}],null,!0)})],1)],1)],1),e(h["a"],{staticClass:"px-5",attrs:{value:"ref2"}},[e(u["a"],{staticClass:"mt-5"},[e(i["a"],{attrs:{md:"4",cols:"4"}},[e(f["a"],{attrs:{label:"Nro Operacion"},model:{value:t.$store.state.bank.record.nro_operacion,callback:function(e){t.$set(t.$store.state.bank.record,"nro_operacion",e)},expression:"$store.state.bank.record.nro_operacion"}})],1),e(i["a"],{attrs:{cols:"4",md:"4"}},[e(f["a"],{attrs:{type:"date",label:"Fecha "},model:{value:t.$store.state.bank.record.fecha_pago,callback:function(e){t.$set(t.$store.state.bank.record,"fecha_pago",e)},expression:"$store.state.bank.record.fecha_pago"}})],1),e(i["a"],{attrs:{md:"4",cols:"4"}},[e(r["a"],{attrs:{text:""},on:{click:function(e){return t.abrirSoporte(t.$store.state.bank.record.ruta)}}},[e(d["a"],{attrs:{color:"red"}},[t._v("mdi-file-pdf-box")]),t._v(" "+t._s(t.$store.state.bank.record.nombre_archivo)+" ")],1),e(c["a"],[t.boolFile?t._e():e(l["a"],{attrs:{label:"Soporte de Pago","show-size":"","truncate-length":"50","hide-details":""},model:{value:t.payfile,callback:function(e){t.payfile=e},expression:"payfile"}})],1)],1),e(i["a"],{attrs:{md:"4",cols:"4"}},[e(o["a"],{attrs:{items:t.cuentas,"item-text":"label","item-value":"id",label:"Cuenta Destino (PIC)","return-object":""},model:{value:t.$store.state.bank.record.id_cuentadestino,callback:function(e){t.$set(t.$store.state.bank.record,"id_cuentadestino",e)},expression:"$store.state.bank.record.id_cuentadestino"}})],1),e(i["a"],{attrs:{md:"4",cols:"4"}},[e(m["a"],{attrs:{items:t.$store.state.itemsDataBanksList,label:"Banco Origen","item-text":"acronym","item-value":"id"},model:{value:t.$store.state.bank.record.id_banco_origin,callback:function(e){t.$set(t.$store.state.bank.record,"id_banco_origin",e)},expression:"$store.state.bank.record.id_banco_origin"}})],1),e(i["a"],{attrs:{md:"12",cols:"12"}},[e(c["a"],{attrs:{"text-right":""}},[e(r["a"],{attrs:{loading:t.loading,color:"success"},on:{click:function(e){return t.actualizarCobro()}}},[t._v(" Actualizar ")])],1)],1)],1)],1)],1)],1)},_=[],v=(a("e9f5"),a("910d"),a("7d54"),a("bc3a")),k=a.n(v),x=a("3d20"),y=a.n(x),C=a("2f62"),P={props:["tipo"],data(){return{loading:!1,date:"",symbol:"USD",payfile:[],selected:[],id_coins:1,payPath:"",id_proveedor:"",boolFile:!1,cuentas:[],id_cuenta:"",itemsClientes:[],tab:null,total:0,step2:!0,name_path:"",url_documento:"",totalPagado:0,nro_operacion:"",id_banco_origen:"",headers:[{text:"House",value:"tipo_gasto"},{text:"Monto Dolar",value:"montodolar"},{text:"Moneda",value:"moneda"},{text:"Tipo Cambio",value:"tipocambio"},{text:"Pago Mon Ex",value:"monto_destino"},{text:"Acción",value:"action"}]}},async mounted(){let t=this;t.$store.state.spiner=!0,await t._getBanksList(),await t.cargarClientes(),await t.obtenerListado(),await t.getListBanksDetailsCargar(),await t.getListBanksDetailsCargar(),await t.limpiarDatos(),await t.obtenerDatos(),await t._getCoinsList(),await this.verCobroRealizado(this.$route.params.nro_operacion),t.$store.state.spiner=!1,t.$store.state.drawer=!1},methods:{...Object(C["b"])(["_getListaPagosXProveedorCxC","getListBanksDetailsCargar","_getCoinsList","cargarClientes","_getBanksList","verCobroRealizado","anularCobroRealizado","actualizarPagoRealizado"]),async obtenerListado(){this.$store.state.listPagosXProveedorCxP.listPagosXProveedorCxP=[],this.date="",this.payfile=[],this.boolFile=!1,this.id_cuenta="",this.id_banco_origen="",this.nro_operacion="",this.id_proveedor.id&&"nuevo"==this.tipo?await this._getListaPagosXProveedorCxC(this.id_proveedor.id):this.selected=[]},async actualizarCobro(){let t=await this.actualizarPagoRealizado(this.$store.state.bank.record.details);y.a.fire({icon:t.estadoflag?"success":"error",text:t.mensaje}).then(t=>{t.isConfirmed&&this.$router.go(-1)})},getMontoTotal(){let t=0;return this.$store.state.bank.record.details.forEach(e=>{t+=parseFloat(e.monto_destino)}),parseFloat(t).toFixed(2)},async getListBanksDetailsCargar(){let t=this;var e={method:"get",url:"https://api.agentedecargaonline.com/getListBanksDetailsCargar",params:{id_branch:JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch},headers:{"auth-token":sessionStorage.getItem("auth-token"),"Content-Type":"application/json"}};await k()(e).then((function(e){t.cuentas=e.data.data})).catch((function(t){console.log(t)}))},validarMonto(t){parseFloat(t.max_pagar)<parseFloat(t.monto_deuda)?document.getElementById("pago"+t.id).focus():this.calcularTotal()},obtenerSymbol(){this.symbol=this.$store.state.itemsCoinsList.filter(t=>t.id==this.id_coins)[0].symbol},calcularMonto(){this.selected.length>0&&(this.selected.forEach(t=>{this.id_coins=t.id_coins,this.symbol=this.$store.state.itemsCoinsList.filter(t=>t.id==this.selected[0].id_coins)[0].symbol,t.montopagar=parseFloat(t.monto_pagar*t.tipocambio).toFixed(2),t.montopagar>t.max_pagar?t.err="Monto Superior a la deuda ":t.err=""}),this.calcularTotal(),this.obtenerSymbol())},calcularTotal(){let t=0;this.selected.forEach(e=>{t+=parseFloat(e.montopagar)}),this.total=parseFloat(t).toFixed(4)},async anularCobro(t){await y.a.fire({icon:"question",text:"¿Está seguro que desea anular el cobro realizado. ? Recuerde que este cambio no es reversible.",confirmButtonText:"Si, anular",cancelButtonText:"Cancelar",showDenyButton:!1,showCancelButton:!0}).then(async e=>{e.isConfirmed&&(await this.anularCobroRealizado(t),this.$router.go(-1))})},_uploadFile(){var t=a("5a30"),e=(a("3e8f"),new t),o=this;e.append("name","Prueba"),e.append("file",o.payfile);var r={method:"post",url:"https://api.agentedecargaonline.com/uploadAllPath",headers:{"auth-token":sessionStorage.getItem("auth-token"),"Content-Type":"application/json"},data:e};k()(r).then((function(t){o.boolFile=!0,o.payPath=JSON.stringify(t.data.data[0].insertid)})).catch((function(t){console.log(t)}))},validar(t=!1){let e=!0,a="";return this.listPagosXProveedorCxP.forEach(t=>{let o=0;o=parseFloat(t.monto_deuda).toFixed(4);let r=0;r=parseFloat(t.max_pagar).toFixed(4),parseFloat(o)>parseFloat(r)&&(e=!1,a="No puede realizar un pago mayor a la deuda. ")}),!this.payPath&&t&&(e=!1,a+="Por favor, seleccione un documento para soporte de pago. "),!this.id_cuenta&&t&&(e=!1,a+="Por favor, seleccione una cuenta. "),0==this.selected.length&&(e=!1,a+="Seleccione al menos una cuenta a pagar. "),e||this.$swal({icon:"error",title:"Lo sentimos",text:a}),e},async _putPayForProveedor(){try{if(this.validar(!0)){let a=this;a.loading=!0;var t={id_proveedor:a.id_proveedor.id,id_path:a.payPath,details:a.selected,id_cuenta:a.id_cuenta.id,fecha:a.date,nro_operacion:a.nro_operacion,id_banco_origen:a.id_banco_origen,id_coins:a.id_coins},e={method:"post",url:"https://api.agentedecargaonline.com/setPayForCustomer",headers:{"auth-token":sessionStorage.getItem("auth-token"),"Content-Type":"application/json"},data:t};await k()(e).then((function(t){1==t.data.statusBol&&(a.$swal({icon:"success",title:"Aviso",text:t.data.data.msg}),a.limpiarDatos())})).catch((function(t){console.log(t)})),this.loading=!1}}catch(a){console.log(a)}},continuar(){this.validar()&&(this.step2=!1,this.tab="ref2")},limpiarDatos(){this.payfile=[],this.payPath="",this.id_proveedor="",this.selected=[],this.boolFile=!1,this.tab="ref1",this.step2=!0,this.total=0,this.$store.state.listPagosXProveedorCxP=[]},async obtenerDatos(){if("ver"==this.tipo){let e=this,a=e.$route.params.id;var t={method:"get",url:"https://api.agentedecargaonline.com/getVerPagosPorCustomer?id="+a,headers:{"auth-token":sessionStorage.getItem("auth-token"),"Content-Type":"application/json"}};await k()(t).then((function(t){e.step2=!1,e.id_proveedor=data.id_proveedor,e.$store.state.listPagosXProveedorCxP=data.details,e.id_cuenta=data.id_bank,e.name_path=data.documento,e.url_documento=data.link_documento,setTimeout(()=>{e.calcularTotalPagado()},200)})).catch((function(t){console.log(t)}))}},abrirSoporte(t){console.log(t),window.open(t,"_blank")}},computed:{...Object(C["c"])(["itemsProveedorList","listPagosXProveedorCxP","clientes"])},watch:{selected(){this.calcularMonto()}}},$=P,w=a("2877"),F=Object(w["a"])($,g,_,!1,null,null,null);e["default"]=F.exports}}]);