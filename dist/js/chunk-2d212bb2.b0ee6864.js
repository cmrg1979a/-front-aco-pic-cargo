(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d212bb2"],{aa51:function(e,t,a){"use strict";a.r(t);var s=a("c6a6"),i=a("8336"),r=a("b0af"),n=a("99d9"),l=a("cc20"),o=a("62ad"),c=a("a523"),u=a("8fea"),d=a("169a"),p=a("23a7"),m=a("4bd4"),_=a("8e36"),b=a("0fd9"),h=a("2fa4"),g=a("b73d"),f=a("71a3"),v=a("c671"),C=a("fe57"),y=a("aac8"),x=a("8654"),k=function(){var e=this,t=e._self._c;return t(c["a"],[t(r["a"],{staticClass:"py-10 px-10"},[e.loading_as?t(c["a"],{staticStyle:{height:"400px"}},[t(b["a"],{staticClass:"fill-height",attrs:{"align-content":"center",justify:"center"}},[t(o["a"],{staticClass:"text-subtitle-1 text-center",attrs:{cols:"12"}},[e._v(" Cargando información .... ")]),t(o["a"],{attrs:{cols:"6"}},[t(_["a"],{attrs:{color:"deep-purple accent-4",indeterminate:"",rounded:"",height:"6"}})],1)],1)],1):t(C["a"],{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t(f["a"],{attrs:{href:"#principal"}},[e._v("Datos Principales")]),t(f["a"],{attrs:{href:"#bancario"}},[e._v("Datos Bancarios")])],1),e.loading_as?e._e():t(y["a"],{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[t(v["a"],{staticClass:"px-10",attrs:{value:"principal"}},[t(n["d"],[t(n["c"],[t(b["a"],[t(m["a"],{ref:"form",staticClass:"my-4"},[t(b["a"],[t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(s["a"],{attrs:{label:"Tipo de Documento (*)",items:e.itemsDocumentsPais,"item-text":"description","item-value":"id",rules:[e=>!!e||"Dato requerido"],clearable:""},model:{value:e.enterprise.id_document,callback:function(t){e.$set(e.enterprise,"id_document",t)},expression:"enterprise.id_document"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(x["a"],{attrs:{type:"text",label:"N° de Documento (*)",rules:[e=>!!e||"Dato requerido",e=>e&&e.length<=100||"Hasta 100 caracteres permitidos"],"error-messages":e.errorDocument,clearable:""},on:{blur:e.validateDocument},model:{value:e.enterprise.document,callback:function(t){e.$set(e.enterprise,"document",t)},expression:"enterprise.document"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(x["a"],{attrs:{label:"Nombre Comercial (*)",rules:[e=>!!e||"Dato requerido",e=>e&&e.length<=255||"Hasta 255 caracteres permitidos"],clearable:""},model:{value:e.enterprise.trade_name,callback:function(t){e.$set(e.enterprise,"trade_name",t)},expression:"enterprise.trade_name"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(x["a"],{attrs:{label:"Nombre Negocio (*)",rules:[e=>!!e||"Dato requerido",e=>e&&e.length<=255||"Hasta 255 caracteres permitidos"],clearable:""},model:{value:e.enterprise.business_name,callback:function(t){e.$set(e.enterprise,"business_name",t)},expression:"enterprise.business_name"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(x["a"],{attrs:{label:"Teléfono"},model:{value:e.enterprise.phone,callback:function(t){e.$set(e.enterprise,"phone",t)},expression:"enterprise.phone"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(x["a"],{attrs:{label:"Slogan",clearable:"",rules:[t=>e.validateLength(t,255)]},model:{value:e.enterprise.slogan,callback:function(t){e.$set(e.enterprise,"slogan",t)},expression:"enterprise.slogan"}})],1),t(o["a"],{staticClass:"py-0 text-left",attrs:{cols:"6"}},[t(x["a"],{attrs:{label:"Logo",readonly:"",value:e.enterprise.name_file}})],1),t(o["a"],{staticClass:"py-0 text-left",attrs:{cols:"6"}},[t(p["a"],{attrs:{label:"Actualizar logo",accept:".png","success-messages":e.msgfile,"error-messages":e.errfile,loading:e.loadingFile,"show-size":"","prepend-icon":"mdi-camera"},on:{change:function(t){return e.uploadFile()}},model:{value:e.payfile,callback:function(t){e.payfile=t},expression:"payfile"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(x["a"],{attrs:{label:"IC",rules:[t=>e.validateLength(t,255)],clearable:""},model:{value:e.enterprise.ic,callback:function(t){e.$set(e.enterprise,"ic",t)},expression:"enterprise.ic"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(s["a"],{attrs:{label:"País (*)",items:e.itemsPais,"item-value":"id","item-text":"name",rules:[e=>!!e||"Dato requerido"],clearable:""},on:{change:function(t){return e.get_state()}},model:{value:e.enterprise.id_pais,callback:function(t){e.$set(e.enterprise,"id_pais",t)},expression:"enterprise.id_pais"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(s["a"],{attrs:{label:"Región (*)",items:e.itemsState,"item-value":"id","item-text":"name",disabled:!e.enterprise.id_pais,clearable:""},on:{change:function(t){return e.get_city()}},model:{value:e.enterprise.id_state,callback:function(t){e.$set(e.enterprise,"id_state",t)},expression:"enterprise.id_state"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(s["a"],{attrs:{label:"Provincia (*)",items:e.itemsCity,"item-value":"id","item-text":"name",disabled:!e.enterprise.id_state,clearable:""},on:{change:function(t){return e.get_town()}},model:{value:e.enterprise.id_city,callback:function(t){e.$set(e.enterprise,"id_city",t)},expression:"enterprise.id_city"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(s["a"],{attrs:{label:"Distrito (*)",items:e.itemsTown,"item-value":"id","item-text":"name",disabled:!e.enterprise.id_city,clearable:""},model:{value:e.enterprise.id_town,callback:function(t){e.$set(e.enterprise,"id_town",t)},expression:"enterprise.id_town"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(x["a"],{attrs:{label:"Dirección (*)",clearable:"",rules:[e=>!!e||"Dato requerido"]},model:{value:e.enterprise.address,callback:function(t){e.$set(e.enterprise,"address",t)},expression:"enterprise.address"}})],1),t(o["a"],{staticClass:"py-0",attrs:{cols:"6"}},[t(g["a"],{attrs:{label:"Activo / Inactivo",color:"success"},on:{change:e.updateStatus},model:{value:e.enterprise.status,callback:function(t){e.$set(e.enterprise,"status",t)},expression:"enterprise.status"}})],1),t(o["a"],{attrs:{cols:"6"}},[t(s["a"],{attrs:{label:"Impuestos a las Ventas en tu País",items:e.$store.state.masterusuarios.lstImpRenta,"item-value":"id","item-text":"descripcion",dense:""},scopedSlots:e._u([{key:"selection",fn:function(a){return[a.item?t("span",[e._v(e._s(a.item.codigo))]):e._e()]}}],null,!1,1416533199),model:{value:e.enterprise.tipoimpuesto,callback:function(t){e.$set(e.enterprise,"tipoimpuesto",t)},expression:"enterprise.tipoimpuesto"}})],1),t(o["a"],{attrs:{cols:"6"}},[t(x["a"],{attrs:{type:"number",label:"Porcentaje",step:"0.1",suffix:"%",dense:"","hide-details":""},model:{value:e.enterprise.impuesto,callback:function(t){e.$set(e.enterprise,"impuesto",t)},expression:"enterprise.impuesto"}})],1)],1)],1)],1)],1)],1)],1),t(v["a"],{attrs:{value:"bancario"}},[t(b["a"],[t(o["a"],{staticStyle:{"text-align":"right"},attrs:{cols:"12"}},[t(i["a"],{attrs:{color:"success",small:""},on:{click:e.abrirModalNuevaCuenta}},[e._v("Nueva Cuenta")])],1),t(o["a"],{attrs:{cols:"12"}},[t(u["a"],{attrs:{headers:e.headerCuentas,items:e.$store.state.enterprises.lstCuentas},scopedSlots:e._u([{key:"item.esprincipalflag",fn:function({item:a}){return[a.esprincipalflag?t(l["a"],{staticClass:"ma-2",attrs:{color:"green","text-color":"white"}},[e._v(" SI ")]):e._e()]}}],null,!0)})],1)],1)],1)],1),e.loading_as?e._e():t(n["a"],{staticClass:"justify-end mt-3"},[t(i["a"],{staticClass:"mx-1",attrs:{small:"",color:"success",rounded:""},on:{click:function(t){return e.update()}}},[e._v(" Guardar ")]),t(i["a"],{staticClass:"mx-1",attrs:{small:"",dark:"",color:"red",rounded:""},on:{click:function(t){return e.volver()}}},[e._v(" Cancelar ")])],1)],1),t(d["a"],{attrs:{scrollable:"","max-width":"30%"},model:{value:e.dialogNuevaCuenta,callback:function(t){e.dialogNuevaCuenta=t},expression:"dialogNuevaCuenta"}},[t(r["a"],[t(n["d"],[e._v(" Nueva Cuenta ")]),t(n["c"],[t(m["a"],{ref:"frmNuevaCuenta"},[t(s["a"],{attrs:{items:e.$store.state.bank.list,"item-text":"name","item-value":"id",label:"Banco"},model:{value:e.id_bank,callback:function(t){e.id_bank=t},expression:"id_bank"}}),0==e.id_bank?t(x["a"],{attrs:{rules:[e=>!!e||"Dato Requerido"],label:"Acrónimo Banco",id:"id"},model:{value:e.acronymbanco,callback:function(t){e.acronymbanco=t},expression:"acronymbanco"}}):e._e(),0==e.id_bank?t(x["a"],{attrs:{rules:[e=>!!e||"Dato Requerido"],label:"Nombre Banco",id:"id"},model:{value:e.nombrebanco,callback:function(t){e.nombrebanco=t},expression:"nombrebanco"}}):e._e(),t(s["a"],{attrs:{items:e.$store.state.coins.itemsCoinsList,"item-text":"name","item-value":"id",label:"Moneda",rules:[e=>"0"===e||0===e||!!e||"Dato Requerido"]},model:{value:e.id_coins,callback:function(t){e.id_coins=t},expression:"id_coins"}}),t(x["a"],{attrs:{rules:[e=>!!e||"Dato Requerido"],label:"Número Cuenta"},model:{value:e.nro_cuenta,callback:function(t){e.nro_cuenta=t},expression:"nro_cuenta"}}),t(x["a"],{attrs:{rules:[e=>!!e||"Dato Requerido"],label:"CCI"},model:{value:e.nro_cci,callback:function(t){e.nro_cci=t},expression:"nro_cci"}}),t(g["a"],{attrs:{label:"Usar en Facturación"},model:{value:e.esprincipalflag,callback:function(t){e.esprincipalflag=t},expression:"esprincipalflag"}}),e.bloquearEsPrincipal&&e.esprincipalflag?t("span",{staticClass:"mt-0",staticStyle:{color:"red"}},[t("p",{staticClass:"my-0",staticStyle:{"font-size":"0.8rem"}},[e._v(" Ya existe una cuenta configurada para usar en facturación, ")]),t("p",{staticClass:"my-0",staticStyle:{"font-size":"0.8rem"}},[e._v(" Se actualizará el registro ")])]):e._e()],1),t("div",{staticClass:"mt-5",staticStyle:{"text-align":"right"}},[t(h["a"]),t(i["a"],{staticClass:"mx-1",attrs:{small:"",color:"success"},on:{click:e.guardarCuenta}},[e._v("Guardar")]),t(i["a"],{staticClass:"mx-1",attrs:{small:"",color:"error"},on:{click:function(t){e.dialogNuevaCuenta=!1}}},[e._v("Cancelar")])],1)],1)],1)],1)],1)},w=[],$=(a("e9f5"),a("a732"),a("bc3a")),D=a.n($),S=a("2f62"),N=a("54e1"),P={mixins:[N["a"]],name:"UpdateEnterpriseComponent",data(){return{dialogNuevaCuenta:!1,enterprise:{id_branch:JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch,id:this.$route.params.id,id_logo:"",document:"",trade_name:"",business_name:"",slogan:"",address:"",status:"",id_pais:"",id_state:"",id_city:"",id_town:null,id_document:"",phone:"",ic:"",originalname:"",name_file:"",impuesto:"",tipoimpuesto:""},rulesPassed:!1,loading_as:!0,errfile:"",loadingFile:!1,msgfile:"",payfile:null,errorDocument:null,tab:"principal",headerCuentas:[{text:"Banco",value:"banco"},{text:"Abrv.",value:"banco_acronym"},{text:"Nro Cuenta",value:"nrocuenta"},{text:"CCI",value:"nrocci"},{text:"Usar Facturación",value:"esprincipalflag"},{text:"Moneda",value:"moneda"},{text:"Abrv. Moneda",value:"monedacronym"}],id_bank:0,id_coins:"",nro_cuenta:"",nro_cci:"",esprincipalflag:!1,acronymbanco:"",nombrebanco:""}},async mounted(){await this.readEnterprise(this.$route.params.id),await Promise.all([this.cargarImpuestoRenta(),this._getDocumentsPais(),this._getPais(),this.listarCuentaEmpresa(this.$route.params.id),this.fetchDataBank({code:"",name:"",acronym:"",description:"",status:""}),this.getCoinsListCargar()]),this.$store.state.bank.list.unshift({id:0,name:"Crear Nuevo Banco"}),this.$store.state.mainTitle="ACTUALIZAR EMPRESA"},watch:{"$store.state.enterprises.record":{handler(e,t){if(e&&Object.keys(e).length>0){const t=["id_logo","document","trade_name","business_name","slogan","address","status","id_pais","id_state","id_city","id_town","id_document","ic","originalname","name_file","impuesto","tipoimpuesto","phone"];this._getState(e.id_pais),this._getCity(e.id_state),this._getTown(e.id_city),t.forEach(t=>{this.enterprise[t]=e[t]}),this.loading_as=!1}},immediate:!0},"$store.state.files.payPath":{handler(e,t){e&&(this.enterprise.id_logo=e)},immediate:!0}},methods:{...Object(S["b"])(["updateEnterprise","readEnterprise","_getDocumentsPais","_getPais","_getState","_getCity","_getTown","_uploadFile","cargarImpuestoRenta","listarCuentaEmpresa","fetchDataBank","getCoinsListCargar","registrarCuentaEmpresa"]),_callState(){this.id_pais>0&&this._getState(this.id_pais)},abrirModalNuevaCuenta(){this.dialogNuevaCuenta=!0,this.$nextTick(()=>{this.$refs.frmNuevaCuenta.reset(),setTimeout(()=>{this.id_bank=0,this.esprincipalflag=!1},500)})},volver(){this.$router.go(-1)},async get_state(){this.enterprise.id_state="",this.enterprise.id_city="",this.enterprise.id_town=null,await this._getState(this.enterprise.id_pais)},async get_city(){this.enterprise.id_city="",this.enterprise.id_town=null,await this._getCity(this.enterprise.id_state)},async get_town(){this.enterprise.id_town=null,await this._getTown(this.enterprise.id_city)},async update(){this.$refs.form.validate()&&await this.updateEnterprise(this.enterprise)},updateStatus(e){this.enterprise.status=e?1:0},async validateDocument(){this.errorDocument=null;var e={method:"get",url:"https://api.agentedecargaonline.com/validar_editar_documento_enterprise?id="+this.enterprise.id+"&id_document="+this.enterprise.id_document+"&id_branch="+this.enterprise.id_branch+"&document="+encodeURIComponent(this.enterprise.document),headers:{"Content-Type":"application/json","auth-token":sessionStorage.getItem("auth-token")}};await D()(e).then(e=>{let t=e.data;t.estadoflag?this.errorDocument="":(this.errorDocument=t.mensaje,this.enterprise.document="")}).catch(e=>{console.log("Error al obtener los datos:",e)})},async uploadFile(){this.msgfile="",this.errfile="",this.payfile&&(this.loadingFile=!0,this.payfile.size>2097152?(this.loadingFile=!1,this.errfile="El archivo es demasiado grande. El tamaño máximo es 2 MB."):(await this._uploadFile(this.payfile),this.loadingFile=!1,this.$store.state.files.payPath?this.msgfile="Archivo cargado":this.errfile="Comuniquese con el admistrador",this.$store.state.files.payPath&&(this.enterprise.name_file="")))},async guardarCuenta(){this.$refs.frmNuevaCuenta.validate()&&(await this.registrarCuentaEmpresa({id_banco:this.id_bank,id_coins:this.id_coins,numerocuenta:this.nro_cuenta,cci:this.nro_cci,esprincipalflag:this.esprincipalflag,acronymbanco:this.acronymbanco,nombrebanco:this.nombrebanco}),this.dialogNuevaCuenta=!1,await this.fetchDataBank({code:"",name:"",acronym:"",description:"",status:""}))}},computed:{...Object(S["c"])(["itemsDocumentsPais","itemsPais","itemsState","itemsCity","itemsTown"]),bloquearEsPrincipal(){let e=this.$store.state.enterprises.lstCuentas.some(e=>e.esprincipalflag);return e}}},E=P,q=a("2877"),I=Object(q["a"])(E,k,w,!1,null,null,null);t["default"]=I.exports}}]);