(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58d1dc87"],{"2ca3":function(t,a,s){"use strict";s("5bc6")},"5bc6":function(t,a,s){},bf94:function(t,a,s){"use strict";s.r(a);var e=s("62ad"),o=s("a523"),i=s("ce7e"),r=s("0fd9"),n=s("7e85"),c=s("e516"),d=s("9c54"),l=s("56a4"),p=function(){var t=this,a=t._self._c;return a(o["a"],{staticClass:"pt-0 px-0",attrs:{fluid:""}},[a(n["a"],{staticClass:"pt-0",model:{value:t.step,callback:function(a){t.step=a},expression:"step"}},[a(d["a"],[a(l["a"],{attrs:{complete:t.step>1,step:"1",editable:""}},[t._v(" Datos de la Carga ")]),a(i["a"]),a(l["a"],{attrs:{complete:t.step>2,step:"2",editable:t.editableStep2}},[t._v(" costos de la Cotización ")]),a(i["a"]),a(l["a"],{attrs:{step:"3"}},[t._v(" Comparativa ")]),a(i["a"]),a(l["a"],{attrs:{step:"4"}},[t._v(" Notas de Costos ")])],1),a(d["b"],[a(c["a"],{attrs:{step:"1"}},[a(r["a"],[a(e["a"],{staticClass:"pt-0",attrs:{cols:"12",md:"6"}},[a(r["a"],[a(e["a"],{staticClass:"my-0 py-0",attrs:{cols:"12"}},[a("DatosPrincipales",{on:{recargarServiciosCostos:t.recargarServiciosCostos,activarDatosCarga:t.activarDatosCarga}})],1)],1)],1),a(e["a"],{staticClass:"my-0 py-0",attrs:{cols:"12",md:"6",id:"DatosCargaComponent"}},[t.DatosCargaComponentFlag?a("DatosCargaComponent",{on:{activarServicios:function(a){return t.activarServicios()},recargarCostos:t.recargarCostos}}):t._e()],1),a(e["a"],{attrs:{cols:"12",id:"ServicesComponent"}},[t.ServicesComponentFlag?a("ServicesComponent",{on:{activarLlenadoCostos:function(a){return t.activarLlenadoCostos()},recargarCostos:function(a){return t.recargarCostos()}}}):t._e()],1)],1)],1),a(c["a"],{attrs:{step:"2"}},[a("DatosCostosComponent",{key:t.indexCostos,attrs:{mostrarImpuestosEditar:!0},on:{anadirNuevaOpcion:t.anadirNuevaOpcion,continuarComparativa:t.continuarComparativa,irANotas:t.irANotas}})],1),a(c["a"],{attrs:{step:"3"}},[a("ComparativaComponent",{on:{irVentaCliente:t.irVentaCliente}})],1),a(c["a"],{attrs:{step:"4"}},[a("NotasComponent",{attrs:{editable:t.editableStep4}})],1)],1)],1)],1)},u=[],h=(s("14d9"),s("e9f5"),s("910d"),s("796d"),s("7d54"),s("ab43"),s("1e70"),s("79a4"),s("c1a1"),s("8b00"),s("a4e7"),s("1e5a"),s("72c3"),s("7cc7")),g=s("2733"),C=s("5d85"),m=s("7e82"),v=s("e017"),$=s("387e"),f=s("2f62"),_=s("3d20"),S=s.n(_),w={components:{DatosPrincipales:h["a"],DatosCargaComponent:g["a"],ServicesComponent:C["a"],DatosCostosComponent:m["a"],ComparativaComponent:v["a"],NotasComponent:$["a"]},data(){return{step:1,DatosCargaComponentFlag:!1,ServicesComponentFlag:!1,editableStep2:!1,editableStep4:!1,recargarSegmentos:!1,indexCostos:0}},async mounted(){this.$store.state.mainTitle="Nueva Cotización",await this.resetQuoteNew(),await this.getMarketingList(),await this.getQuoteStatus(),await this.getModalityAduana(),await this.getShipmentAduana(),await this.getIncotermsAduana(),await this.getCargarEjecutivo(),await this.getBegEndList(),await this.getServicesAduana(),await this.obtenerCostosAduana(),await this.cargarProveedores(),await this.getImpuestos(),await this.getCargarMasterDetalleNotasCotizacionAduana(),await this.obtenerImpuestoXEmpresa(),await this.cargarMasterDetallePercepcionAduana(),await this._getContainers()},methods:{...Object(f["b"])(["resetQuoteNew","getMarketingList","getQuoteStatus","getModalityAduana","getShipmentAduana","getIncotermsAduana","getCargarEjecutivo","getPortBeginAduana","getPortEndAduana","getServicesAduana","getBegEndList","getTipoCostosAduana","obtenerCostosAduana","getMultiplicadorAduana","getImpuestos","getCargarMasterDetalleNotasCotizacionAduana","cargarProveedores","obtenerImpuestoXEmpresa","registrarQuote","cargarMasterDetallePercepcionAduana","_getContainers"]),recargar(){this.$store.state.aduana.listServices.length>0&&(this.recargarServicios(),this.getTipoCostosAduana()),this.editableStep2&&this.recargarCostos()},continuarComparativa(){this.step=3},async activarDatosCarga(){this.$store.state.spiner=!0,await this.getPortBeginAduana({id_transport:this.$store.state.aduana.datosPrincipales.idtipocarga.id_transport?this.$store.state.aduana.datosPrincipales.idtipocarga.id_transport:this.$store.state.aduana.datosPrincipales.idtipocarga}),await this.getPortEndAduana({id_transport:this.$store.state.aduana.datosPrincipales.idtipocarga.id_transport?this.$store.state.aduana.datosPrincipales.idtipocarga.id_transport:this.$store.state.aduana.datosPrincipales.idtipocarga}),this.DatosCargaComponentFlag=!0,this.$nextTick(()=>{const t=document.getElementById("DatosCargaComponent");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}),this.$store.state.spiner=!1},async activarServicios(){this.ServicesComponentFlag=!0;let t=[...this.$store.state.aduana.preServices],a=t.filter(t=>t.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.aduana.datosPrincipales.idtipocarga.id);this.getTipoCostosAduana(),this.$store.state.aduana.listServices=a,this.$nextTick(()=>{const t=document.getElementById("ServicesComponent");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}),this.$store.state.spiner=!1},recargarServiciosCostos(){let t=[...this.$store.state.aduana.preServices];if(0==t.length)return;let a=t.filter(t=>t.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.aduana.datosPrincipales.idtipocarga.id),s=a.map(t=>t.id);this.$store.state.aduana.listServices.filter(t=>!!t.id).forEach(t=>{if(!s.includes(t.id)){let a=this.$store.state.aduana.listServices.findIndex(a=>a.code_service==t.code_service);this.$store.state.aduana.listServices.splice(a,1)}}),s=this.$store.state.aduana.listServices.map(t=>t.code_service),a.forEach(t=>{s.includes(t.code_service)||this.$store.state.aduana.listServices.push(t)}),this.recargarCostos()},async activarLlenadoCostos(){try{this.$store.state.spiner=!0,await this.getMultiplicadorAduana();let t=new Set(this.$store.state.aduana.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),a=[...this.$store.state.aduana.preCostos],s=a.filter(a=>a.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&a.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&a.id_shipment==this.$store.state.aduana.datosPrincipales.idtipocarga.id&&t.has(a.code_service)),e=[];this.$store.state.aduana.datosPrincipales.containers.length>0&&(e=this.$store.state.aduana.datosPrincipales.containers.map(t=>t.id));let o=s.filter(t=>!t.escontenedorflag||e.includes(t.id_container)),i=[69,114,105,39],r=o.flatMap(t=>i.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45),nro_propuesta:1}]:[{...t,nro_propuesta:1,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45),nro_propuesta:1},{...t,nro_propuesta:1,esopcionflag:0,esventaflag:1,status:!0,costounitario:0,cif:0,seguro:0,nro_propuesta:1}]);this.$store.state.aduana.opcionCostos[0].listCostos=r,this.$store.state.aduana.opcionCostos[0].listImpuestos=this.$store.state.aduana.listImpuestos,this.$store.state.aduana.opcionCostos[0].listNotasQuote=this.$store.state.aduana.listNotasQuote,this.$store.state.spiner=!1,S.a.fire({icon:"question",title:"Cotizar",text:"¿Desea pasar a Cotizar?",confirmButtonText:"Pasar a Cotizar",denyButtonText:"Guardar Borrador",allowEnterKey:!1,allowOutsideClick:!1,confirmButtonColor:"green",showDenyButton:!0,allowEscapeKey:!1}).then(async t=>{t.isConfirmed&&(this.step=2,this.editableStep2=!0),t.isDenied&&await this.guardar()})}catch(t){console.log(t)}},async guardar(){if(this.$store.state.spiner=!0,this.$store.state.aduana.opcionCostos[0].selected=!0,await this.registrarQuote({fullflag:!1}).catch(t=>{console.log("registrarQuote",t)}),this.$store.state.aduana.nro_quote){this.$store.state.spiner=!1;let t=this;S.a.fire({icon:"success",title:"Aviso",text:t.$store.state.aduana.mensaje,confirmButtonText:"Ir al listado",showConfirmButton:!0}).then(a=>{a.isConfirmed&&t.$router.push({name:"lstQuote"}),a.isDismissed&&t.$router.push({name:"lstQuote"})});let a=JSON.parse(sessionStorage.getItem("dataUser"))[0].id_branch,s=[1,2];s.includes(a)&&(await this.crearCarpetaOneDrive({nro_quote:this.$store.state.aduana.nro_quote,nombre:this.$store.state.aduana.datosPrincipales.nombre}).catch(t=>{console.log("crearCarpetaOneDrive",t)}),await this.actualizarURLEnElQuote({id:this.$store.state.aduana.id,url:this.$store.state.aduana.urlFolder}).catch(t=>{console.log("actualizarURLEnElQuote",t)}))}},anadirNuevaOpcion(t){let a=new Set(this.$store.state.aduana.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),s=[...this.$store.state.aduana.preCostos],e=s.filter(t=>t.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.aduana.datosPrincipales.idtipocarga.id&&a.has(t.code_service)),o=[];this.$store.state.aduana.datosPrincipales.containers.length>0&&(o=this.$store.state.aduana.datosPrincipales.containers.map(t=>t.id));let i=e.filter(t=>!t.escontenedorflag||o.includes(t.id_container)),r=[69,114,105,39],n=i.flatMap(a=>r.includes(a.code_cost)?[{...a,esopcionflag:1,nro_propuesta:t,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...a,esopcionflag:1,nro_propuesta:t,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...a,esopcionflag:0,nro_propuesta:t,esventaflag:1,status:!0,cif:0,seguro:0,costounitario:0}]),c={nro_propuesta:t,date_end:"",tiempo_transito:0,listCostos:n,listImpuestos:this.$store.state.aduana.listImpuestos,listNotasQuote:this.$store.state.aduana.listNotasQuote};this.$store.state.aduana.opcionCostos.push(c),this.$store.state.spiner=!1},async recargarCostos(){await this.getTipoCostosAduana(),await this.getMultiplicadorAduana();let t=new Set(this.$store.state.aduana.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),a=this.$store.state.aduana.preCostos.filter(a=>a.id_incoterms===this.$store.state.aduana.datosPrincipales.idincoterms&&a.id_modality===this.$store.state.aduana.datosPrincipales.idsentido&&a.id_shipment===this.$store.state.aduana.datosPrincipales.idtipocarga.id&&t.has(a.code_service)),s=[];this.$store.state.aduana.datosPrincipales.containers.length>0&&(s=this.$store.state.aduana.datosPrincipales.containers.map(t=>t.id));let e=a.filter(t=>!t.escontenedorflag||s.includes(t.id_container)),o=[69,114,105,39],i=e.flatMap(t=>o.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,nro_propuesta:1,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,nro_propuesta:1,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:!0,cif:0,seguro:0,costounitario:0}]);this.$store.state.aduana.opcionCostos=this.$store.state.aduana.opcionCostos.slice(0,1),this.$store.state.aduana.index=0,this.$store.state.aduana.opcionCostos[0].listCostos=i,this.$store.state.aduana.opcionCostos[0].listImpuestos=this.$store.state.aduana.listImpuestos,this.$store.state.aduana.opcionCostos[0].listNotasQuote=this.$store.state.aduana.listNotasQuote,this.$store.state.aduana.llenadoCostos=!0,this.$forceUpdate(),this.indexCostos++},irVentaCliente(){this.step=2},irANotas(){this.step=4,this.editableStep4=!0,this.$store.state.aduana.btnRegistrar=!0}},computed:{}},P=w,b=(s("2ca3"),s("2877")),A=Object(b["a"])(P,p,u,!1,null,"e878cb7a",null);a["default"]=A.exports}}]);