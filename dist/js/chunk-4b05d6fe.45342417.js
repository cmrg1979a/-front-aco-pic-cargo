(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b05d6fe"],{"717b":function(t,a,s){"use strict";s.r(a);var e=s("62ad"),i=s("a523"),o=s("ce7e"),r=s("490a"),n=s("0fd9"),d=s("7e85"),c=s("e516"),l=s("9c54"),p=s("56a4"),u=function(){var t=this,a=t._self._c;return t.mostrar?a(i["a"],{staticClass:"pt-0 px-0",attrs:{fluid:""}},[a(d["a"],{staticClass:"pt-0",model:{value:t.step,callback:function(a){t.step=a},expression:"step"}},[a(l["a"],[a(p["a"],{attrs:{complete:t.step>1,step:"1",editable:""}},[t._v(" Datos de la Carga ")]),a(o["a"]),a(p["a"],{attrs:{complete:t.step>2,step:"2",editable:t.mostrarStepS}},[t.mostrarStepS?a("span",[t._v(" costos de la Cotización ")]):a(r["a"],{attrs:{indeterminate:"",color:"primary"}})],1),a(o["a"]),a(p["a"],{attrs:{step:"3",editable:t.mostrarStepS}},[t.mostrarStepS?a("span",[t._v(" Comparativa ")]):a(r["a"],{attrs:{indeterminate:"",color:"primary"}})],1),a(o["a"]),a(p["a"],{attrs:{step:"4",editable:t.mostrarStepS}},[t.mostrarStepS?a("span",[t._v(" Notas de Costos ")]):a(r["a"],{attrs:{indeterminate:"",color:"primary"}})],1)],1),a(l["b"],[a(c["a"],{attrs:{step:"1"}},[a(n["a"],[a(e["a"],{staticClass:"pt-0",attrs:{cols:"12",md:"6"}},[a(n["a"],[a(e["a"],{staticClass:"my-0 py-0",attrs:{cols:"12"}},[a("DatosPrincipales",{attrs:{mostrarBtn:!1,EditableFlag:!1},on:{recargarServiciosCostos:t.recargar,activarDatosCarga:t.activarDatosCarga}})],1)],1)],1),a(e["a"],{staticClass:"my-0 py-0",attrs:{cols:"12",md:"6"}},[a("DatosCargaComponent",{attrs:{mostrarBtn:!1,abrirModalContenedorRecargar:t.abrirModalContenedorRecargar},on:{activarServicios:t.activarServicios,recargarCostos:t.recargarCostos}})],1),a(e["a"],{attrs:{cols:"12"}},[a("ServicesComponent",{attrs:{mostrarBtn:!1},on:{activarLlenadoCostos:function(a){return t.activarLlenadoCostos()},recargarCostos:function(a){return t.recargarCostos()}}})],1)],1)],1),a(c["a"],{attrs:{step:"2"}},[t.mostrarStepS?a("DatosCostosComponent",{key:t.indexCostos,attrs:{mostrarBtn:!1,mostrarImpuestosEditar:!0},on:{anadirNuevaOpcion:t.anadirNuevaOpcion,continuarComparativa:t.continuarComparativa,irANotas:t.irANotas}}):t._e()],1),a(c["a"],{attrs:{step:"3"}},[t.mostrarStepS?a("ComparativaComponent",{on:{irVentaCliente:t.irVentaCliente}}):t._e()],1),a(c["a"],{attrs:{step:"4"}},[t.mostrarStepS?a("NotasComponent",{attrs:{editable:t.editableStep4}}):t._e()],1)],1)],1)],1):t._e()},h=[],g=(s("14d9"),s("e9f5"),s("910d"),s("796d"),s("7d54"),s("ab43"),s("a732"),s("1e70"),s("79a4"),s("c1a1"),s("8b00"),s("a4e7"),s("1e5a"),s("72c3"),s("3d20")),m=s.n(g),C=s("7cc7"),v=s("2733"),f=s("5d85"),$=s("7e82"),S=s("e017"),_=s("387e"),P=s("2f62"),b={components:{DatosPrincipales:C["a"],DatosCargaComponent:v["a"],ServicesComponent:f["a"],DatosCostosComponent:$["a"],ComparativaComponent:S["a"],NotasComponent:_["a"]},data(){return{step:1,mostrarStepS:!1,DatosCargaComponentFlag:!1,ServicesComponentFlag:!1,editableStep2:!1,editableStep4:!1,recargarSegmentos:!1,indexCostos:0,mostrar:!1,abrirModalContenedorRecargar:!1}},async mounted(){this.$store.state.spiner=!0,await Promise.all([await this.getAdunaVer({id:this.$route.params.id}),await this.getShipmentAduana()]),this.$store.state.mainTitle="EDITAR  COTIZACIÓN - "+this.$store.state.aduana.nro_quote,this.$store.state.spiner=!1,this.mostrar=!0;let t=this.$store.state.aduana.listShipment.filter(t=>t.id==this.$store.state.aduana.datosPrincipales.idtipocarga)[0].id_transport,a=[...this.$store.state.aduana.opcionCostos],s=[];a.forEach(t=>{t.listCostos.forEach(t=>{s.some(a=>a==t.id_proveedor)||s.push(t.id_proveedor)})}),Promise.all([this.getPortBeginAduana({id_transport:t,id:this.$store.state.aduana.datosPrincipales.idorigen}),this.getPortEndAduana({id_transport:t,id:this.$store.state.aduana.datosPrincipales.idorigen}),this.getMarketingList(),this.getQuoteStatus(),this.getCargarEjecutivo(),this.getModalityAduana(),this.getIncotermsAduana(),this.cargarMasterDetallePercepcionAduana(),this.getMultiplicadorAduana(),this.getTipoCostosAduana()]),this.mostrarStepS=!0,this.$store.state.aduana.llenadoCostos=!1,await Promise.all([this._getContainers(),this.getBegEndList(),this.obtenerCostosAduana(),this.getServicesAduana(),this.obtenerImpuestoXEmpresa(),this.getPortBeginAduana({id_transport:t,id:this.$store.state.aduana.datosPrincipales.idorigen}),this.getPortEndAduana({id_transport:t,id:this.$store.state.aduana.datosPrincipales.idorigen})]),this.$store.state.aduana.llenadoCostos=!1,this.mostrarStepS=!0},methods:{...Object(P["b"])(["resetQuoteNew","getMarketingList","getQuoteStatus","getModalityAduana","getShipmentAduana","getIncotermsAduana","getCargarEjecutivo","getPortBeginAduana","getPortEndAduana","getServicesAduana","getBegEndList","getTipoCostosAduana","obtenerCostosAduana","getMultiplicadorAduana","getImpuestos","getCargarMasterDetalleNotasCotizacion","cargarProveedores","obtenerImpuestoXEmpresa","registrarQuote","cargarMasterDetallePercepcionAduana","_getContainers","getAdunaVer"]),async recargar(){await this.recargarServicios(),await this.getTipoCostosAduana(),setTimeout(async()=>{await this.recargarCostos()},1e3)},continuarComparativa(){this.step=3},activarDatosCarga(){this.DatosCargaComponentFlag=!0},async activarServicios(){this.ServicesComponentFlag=!0;let t=[...this.$store.state.aduana.preServices],a=t.filter(t=>t.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.aduana.datosPrincipales.idtipocarga.id);this.$store.state.aduana.listServices=a,await this.getTipoCostosAduana()},recargarServicios(){let t=[...this.$store.state.aduana.preServices];if(0==t.length)return;let a=t.filter(t=>t.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&t.id_shipment==("object"===typeof this.$store.state.aduana.datosPrincipales.idtipocarga?this.$store.state.aduana.datosPrincipales.idtipocarga.id:this.$store.state.aduana.datosPrincipales.idtipocarga)),s=a.map(t=>t.id);this.$store.state.aduana.listServices.filter(t=>!!t.id).forEach(t=>{if(!s.includes(t.id)){let a=this.$store.state.aduana.listServices.findIndex(a=>a.code_service==t.code_service);this.$store.state.aduana.listServices.splice(a,1)}}),s=this.$store.state.aduana.listServices.map(t=>t.code_service),a.forEach(t=>{s.includes(t.code_service)||this.$store.state.aduana.listServices.push(t)})},async activarLlenadoCostos(){this.$store.state.spiner=!0,await this.getMultiplicadorAduana(),await this.getImpuestos();let t=new Set(this.$store.state.aduana.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),a=[...this.$store.state.aduana.preCostos],s=a.filter(a=>a.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&a.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&a.id_shipment==this.$store.state.aduana.datosPrincipales.idtipocarga.id&&t.has(Number(a.code_service))),e=[];this.$store.state.aduana.datosPrincipales.containers.length>0&&(e=this.$store.state.aduana.datosPrincipales.containers.map(t=>t.id));let i=s.filter(t=>!t.escontenedorflag||e.includes(t.id_container)),o=[69,114,105,39],r=i.flatMap(t=>o.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:!0,cif:0,seguro:0}]);this.$store.state.aduana.opcionCostos[0].listCostos=r,this.$store.state.aduana.opcionCostos[0].listImpuestos=this.$store.state.aduana.listImpuestos,this.$store.state.aduana.opcionCostos[0].listNotasQuote=this.$store.state.aduana.listNotasQuote,this.step=2,this.editableStep2=!0,this.$store.state.spiner=!1},anadirNuevaOpcion(t){let a=new Set(this.$store.state.aduana.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),s=[...this.$store.state.aduana.preCostos],e=s.filter(t=>t.id_incoterms==this.$store.state.aduana.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.aduana.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.aduana.datosPrincipales.idtipocarga.id&&a.has(Number(t.code_service))),i=[];this.$store.state.aduana.datosPrincipales.containers.length>0&&(i=this.$store.state.aduana.datosPrincipales.containers.map(t=>t.id));let o=e.filter(t=>!t.escontenedorflag||i.includes(t.id_container)),r=[69,114,105,39],n=o.flatMap(t=>r.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:!0,cif:0,seguro:0}]),d={nro_propuesta:t,date_end:"",tiempo_transito:0,listCostos:n,listImpuestos:this.$store.state.aduana.listImpuestos,listNotasQuote:this.$store.state.aduana.listNotasQuote};this.$store.state.aduana.opcionCostos.push(d)},async recargarCostos(t=!0){this.$store.state.spiner=!0,await this.getTipoCostosAduana(),await this.getMultiplicadorAduana();let a=new Set(this.$store.state.aduana.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),s=this.$store.state.aduana.datosPrincipales.idtipocarga;"object"===typeof s&&(s=s.id);let e=this.$store.state.aduana.preCostos.filter(t=>t.id_incoterms===this.$store.state.aduana.datosPrincipales.idincoterms&&t.id_modality===this.$store.state.aduana.datosPrincipales.idsentido&&t.id_shipment===s&&a.has(Number(t.code_service))),i=[];this.$store.state.aduana.datosPrincipales.containers.length>0&&(i=this.$store.state.aduana.datosPrincipales.containers.map(t=>t.id_containers));let o=e.filter(t=>!t.escontenedorflag||i.includes(t.id_container)),r=[69,114,105,39],n=o.flatMap(t=>r.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:1,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,status:1,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:1,cif:0,seguro:0}]),d=[];this.$store.state.aduana.opcionCostos.forEach(t=>{let a=t.listCostos||[],s=a.filter(t=>!t.code_cost||n.some(a=>a.code_cost===t.code_cost)),e=n.filter(t=>!s.some(a=>a.code_cost===t.code_cost&&a.id_multiplicador===t.id_multiplicador)).map(t=>({...t,id:0}));console.log("nuevosCostos",e);let i={...t,listCostos:[...s,...e],listImpuestos:t.listImpuestos,listNotasQuote:t.listNotasQuote,selected:!0};d.push(i)}),this.$set(this.$store.state.aduana,"opcionCostos",d),this.$store.state.aduana.llenadoCostos=!1,this.$forceUpdate(),this.indexCostos++,this.$store.state.spiner=!1;let c=this.$store.state.aduana.listShipment.some(t=>t.id==(this.$store.state.aduana.datosPrincipales.idtipocarga.id?this.$store.state.aduana.datosPrincipales.idtipocarga.id:this.$store.state.aduana.datosPrincipales.idtipocarga)&&"FCL"==t.code);m.a.fire({icon:"success",title:"Actualización Correcta.",text:"Se han activado todas las opciones, actualice los montos de los nuevos registros, y los multiplicadores respectivo.",allowEnterKey:!1,allowOutsideClick:!1}).then(a=>{this.$store.state.aduana.actualizarComparativa=!this.$store.state.aduana.actualizarComparativa,a.isConfirmed&&c&&t&&(this.abrirModalContenedorRecargar=!this.abrirModalContenedorRecargar)})},irVentaCliente(){this.step=2},irANotas(){this.step=4,this.editableStep4=!0}},computed:{...Object(P["c"])(["itemsShipment"])},watch:{step(){this.$store.state.aduana.step=this.step}}},A=b,w=(s("eb81"),s("2877")),y=Object(w["a"])(A,u,h,!1,null,"91f28af8",null);a["default"]=y.exports},e877:function(t,a,s){},eb81:function(t,a,s){"use strict";s("e877")}}]);