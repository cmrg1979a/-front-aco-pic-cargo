(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-471603d8"],{"017d":function(t,s,e){"use strict";e("baf4")},abb5:function(t,s,e){"use strict";e.r(s);var i=e("62ad"),a=e("a523"),o=e("ce7e"),r=e("8e36"),n=e("0fd9"),c=e("7e85"),p=e("e516"),l=e("9c54"),d=e("56a4"),g=function(){var t=this,s=t._self._c;return t.mostrar?s(a["a"],{staticClass:"pt-0 px-0",attrs:{fluid:""}},[s(c["a"],{staticClass:"pt-0",model:{value:t.step,callback:function(s){t.step=s},expression:"step"}},[s(l["a"],[s(d["a"],{attrs:{complete:t.step>1,step:"1",editable:""}},[t._v(" Datos de la Carga ")]),s(o["a"]),s(d["a"],{attrs:{complete:t.step>2,step:"2",editable:t.mostrarStepS}},[s("span",[t._v(" costos de la Cotización ")])]),s(o["a"]),s(d["a"],{attrs:{step:"3",editable:t.mostrarStepS}},[s("span",[t._v(" Comparativa ")])]),s(o["a"]),s(d["a"],{attrs:{step:"4",editable:t.mostrarStepS}},[s("span",[t._v(" Notas de Costos ")])])],1),s(l["b"],[s(p["a"],{attrs:{step:"1"}},[s(n["a"],[s(i["a"],{staticClass:"pt-0",attrs:{cols:"12",md:"6"}},[s(n["a"],[s(i["a"],{staticClass:"my-0 py-0",attrs:{cols:"12"}},[s("DatosPrincipales",{attrs:{mostrarBtn:!1,EditableFlag:!1},on:{recargarServiciosCostos:t.recargar,activarDatosCarga:t.activarDatosCarga}})],1)],1)],1),s(i["a"],{staticClass:"my-0 py-0",attrs:{cols:"12",md:"6"}},[s("DatosCargaComponent",{attrs:{mostrarBtn:!1,abrirModalContenedorRecargar:t.abrirModalContenedorRecargar},on:{activarServicios:t.activarServicios,recargarCostos:t.recargarCostos}})],1),s(i["a"],{attrs:{cols:"12"}},[s("ServicesComponent",{attrs:{mostrarBtn:!1},on:{activarLlenadoCostos:function(s){return t.activarLlenadoCostos()},recargarCostos:function(s){return t.recargarCostos()}}})],1)],1)],1),s(p["a"],{attrs:{step:"2"}},[t.mostrarStepS?s("DatosCostosComponent",{key:t.indexCostos,attrs:{mostrarBtn:!1,mostrarImpuestosEditar:!0},on:{anadirNuevaOpcion:t.anadirNuevaOpcion,continuarComparativa:t.continuarComparativa,irANotas:t.irANotas}}):s(r["a"],{attrs:{color:"light-blue",height:"10",value:"10",striped:""}})],1),s(p["a"],{attrs:{step:"3"}},[t.mostrarStepS?s("ComparativaComponent",{on:{irVentaCliente:t.irVentaCliente}}):t._e()],1),s(p["a"],{attrs:{step:"4"}},[t.mostrarStepS?s("NotasComponent",{attrs:{editable:t.editableStep4}}):t._e()],1)],1)],1)],1):t._e()},h=[],m=(e("14d9"),e("e9f5"),e("910d"),e("796d"),e("7d54"),e("ab43"),e("a732"),e("1e70"),e("79a4"),e("c1a1"),e("8b00"),e("a4e7"),e("1e5a"),e("72c3"),e("3d20")),u=e.n(m),C=e("7047"),v=e("c384"),f=e("24f5"),$=e("93d9"),_=e("4577"),S=e("9fef"),P=e("2f62"),b={components:{DatosPrincipales:C["a"],DatosCargaComponent:v["a"],ServicesComponent:f["a"],DatosCostosComponent:$["a"],ComparativaComponent:_["a"],NotasComponent:S["a"]},data(){return{step:1,mostrarStepS:!1,DatosCargaComponentFlag:!1,ServicesComponentFlag:!1,editableStep2:!1,editableStep4:!1,recargarSegmentos:!1,indexCostos:0,mostrar:!1,abrirModalContenedorRecargar:!1}},async mounted(){this.$store.state.pricing.actualizarCostosFlag=!this.$store.state.pricing.actualizarCostosFlag;let t=Date.now();this.$store.commit("SET_RESET"),this.$store.state.spiner=!0,await Promise.all([await this.getQuote({id:this.$route.params.id}),await this.getShipment()]),this.$store.state.mainTitle="EDITAR  COTIZACIÓN - "+this.$store.state.pricing.nro_quote;let s=this.$store.state.pricing.listShipment.filter(t=>t.id==this.$store.state.pricing.datosPrincipales.idtipocarga)[0].id_transport,e=[...this.$store.state.pricing.opcionCostos],i=[];e.forEach(t=>{t.listCostos.forEach(t=>{i.some(s=>s==t.id_proveedor)||i.push(t.id_proveedor)})}),await this.obtenerProveedorPricing({id:i.join(","),search:null}),this.$store.state.spiner=!1,this.mostrar=!0,await Promise.all([this.getMarketingList(),this.getQuoteStatus(),this.getCargarEjecutivo(),this.getModality(),this.getIncoterms(),this.cargarMasterDetallePercepcionAduana(),this.getMultiplicador(),this.getTipoCostos()]);let a=Date.now(),o=a-t;console.log(o/1e3),this.mostrarStepS=!0,this.$store.state.pricing.llenadoCostos=!1,await Promise.all([this._getContainers(),this.getBegEndList(),this.obtenerCostosPricing(),this.getServices(),this.obtenerImpuestoXEmpresa(),this.getPortBegin({id_transport:s,id:this.$store.state.pricing.datosPrincipales.idorigen}),this.getPortEnd({id_transport:s,id:this.$store.state.pricing.datosPrincipales.iddestino})]),this.$store.state.pricing.actualizarComparativa=!this.$store.state.pricing.actualizarComparativa},methods:{...Object(P["b"])(["obtenerImpuestoXEmpresa","getMarketingList","getQuoteStatus","obtenerProveedorPricing","getModality","getShipment","getIncoterms","getCargarEjecutivo","getQuote","getServices","getBegEndList","getTipoCostos","obtenerCostosPricing","getMultiplicador","getImpuestos","getCargarMasterDetalleNotasCotizacion","cargarProveedores","getImpuestos","obtenerImpuestoXEmpresa","getPortBegin","getPortEnd","_getContainers","cargarMasterDetallePercepcionAduana"]),async recargar(){await this.recargarServicios(),await this.getTipoCostos(),setTimeout(async()=>{await this.recargarCostos()},1e3)},continuarComparativa(){this.step=3},activarDatosCarga(){this.DatosCargaComponentFlag=!0},async activarServicios(){this.ServicesComponentFlag=!0;let t=[...this.$store.state.pricing.preServices],s=t.filter(t=>t.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.pricing.datosPrincipales.idtipocarga.id);this.$store.state.pricing.listServices=s,await this.getTipoCostos()},recargarServicios(){let t=[...this.$store.state.pricing.preServices];if(0==t.length)return;let s=t.filter(t=>t.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&t.id_shipment==("object"===typeof this.$store.state.pricing.datosPrincipales.idtipocarga?this.$store.state.pricing.datosPrincipales.idtipocarga.id:this.$store.state.pricing.datosPrincipales.idtipocarga)),e=s.map(t=>t.id);this.$store.state.pricing.listServices.filter(t=>!!t.id).forEach(t=>{if(!e.includes(t.id)){let s=this.$store.state.pricing.listServices.findIndex(s=>s.code_service==t.code_service);this.$store.state.pricing.listServices.splice(s,1)}}),e=this.$store.state.pricing.listServices.map(t=>t.code_service),s.forEach(t=>{e.includes(t.code_service)||this.$store.state.pricing.listServices.push(t)})},async activarLlenadoCostos(){this.$store.state.spiner=!0,await this.getMultiplicador(),await this.getImpuestos();let t=new Set(this.$store.state.pricing.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),s=[...this.$store.state.pricing.preCostos],e=s.filter(s=>s.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&s.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&s.id_shipment==this.$store.state.pricing.datosPrincipales.idtipocarga.id&&t.has(Number(s.code_service))),i=[];this.$store.state.pricing.datosPrincipales.containers.length>0&&(i=this.$store.state.pricing.datosPrincipales.containers.map(t=>t.id));let a=e.filter(t=>!t.escontenedorflag||i.includes(t.id_container)),o=[69,114,105,39],r=a.flatMap(t=>o.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:!0,cif:0,seguro:0}]);this.$store.state.pricing.opcionCostos[0].listCostos=r,this.$store.state.pricing.opcionCostos[0].listImpuestos=this.$store.state.pricing.listImpuestos,this.$store.state.pricing.opcionCostos[0].listNotasQuote=this.$store.state.pricing.listNotasQuote,this.step=2,this.editableStep2=!0,this.$store.state.spiner=!1},anadirNuevaOpcion(t){let s=new Set(this.$store.state.pricing.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),e=[...this.$store.state.pricing.preCostos],i=e.filter(t=>t.id_incoterms==this.$store.state.pricing.datosPrincipales.idincoterms&&t.id_modality==this.$store.state.pricing.datosPrincipales.idsentido&&t.id_shipment==this.$store.state.pricing.datosPrincipales.idtipocarga.id&&s.has(Number(t.code_service))),a=[];this.$store.state.pricing.datosPrincipales.containers.length>0&&(a=this.$store.state.pricing.datosPrincipales.containers.map(t=>t.id));let o=i.filter(t=>!t.escontenedorflag||a.includes(t.id_container)),r=[69,114,105,39],n=o.flatMap(t=>r.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,status:!0,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:!0,cif:0,seguro:0}]),c={nro_propuesta:t,date_end:"",tiempo_transito:0,listCostos:n,listImpuestos:this.$store.state.pricing.listImpuestos,listNotasQuote:this.$store.state.pricing.listNotasQuote};this.$store.state.pricing.opcionCostos.push(c)},async recargarCostos(t=!0){this.$store.state.spiner=!0,await this.getTipoCostos(),await this.getMultiplicador();let s=new Set(this.$store.state.pricing.listServices.filter(t=>!0===t.status||1===t.status).map(t=>t.code_service)),e=this.$store.state.pricing.datosPrincipales.idtipocarga;"object"===typeof e&&(e=e.id);let i=this.$store.state.pricing.preCostos.filter(t=>t.id_incoterms===this.$store.state.pricing.datosPrincipales.idincoterms&&t.id_modality===this.$store.state.pricing.datosPrincipales.idsentido&&t.id_shipment===e&&s.has(Number(t.code_service))),a=[];this.$store.state.pricing.datosPrincipales.containers.length>0&&(a=this.$store.state.pricing.datosPrincipales.containers.map(t=>t.id_containers));let o=i.filter(t=>!t.escontenedorflag||a.includes(t.id_container)),r=[69,114,105,39],n=o.flatMap(t=>r.includes(t.code_cost)?[{...t,esopcionflag:1,esventaflag:0,status:1,cif:parseFloat(.35),seguro:parseFloat(.45)}]:[{...t,esopcionflag:1,esventaflag:0,status:1,cif:parseFloat(.35),seguro:parseFloat(.45)},{...t,esopcionflag:0,esventaflag:1,status:1,cif:0,seguro:0}]),c=[];this.$store.state.pricing.opcionCostos.forEach(t=>{let s=t.listCostos||[],e=s.filter(t=>!t.code_cost||n.some(s=>s.code_cost===t.code_cost)),i=n.filter(t=>!e.some(s=>s.code_cost===t.code_cost&&s.id_multiplicador===t.id_multiplicador)).map(t=>({...t,id:0}));console.log("nuevosCostos",i);let a={...t,listCostos:[...e,...i],listImpuestos:t.listImpuestos,listNotasQuote:t.listNotasQuote,selected:!0};c.push(a)}),this.$set(this.$store.state.pricing,"opcionCostos",c),this.$store.state.pricing.llenadoCostos=!1,this.$forceUpdate(),this.indexCostos++,this.$store.state.spiner=!1;let p=this.$store.state.pricing.listShipment.some(t=>t.id==(this.$store.state.pricing.datosPrincipales.idtipocarga.id?this.$store.state.pricing.datosPrincipales.idtipocarga.id:this.$store.state.pricing.datosPrincipales.idtipocarga)&&"FCL"==t.code);u.a.fire({icon:"success",title:"Actualización Correcta.",text:"Se han activado todas las opciones, actualice los montos de los nuevos registros, y los multiplicadores respectivo.",allowEnterKey:!1,allowOutsideClick:!1}).then(s=>{this.$store.state.pricing.actualizarComparativa=!this.$store.state.pricing.actualizarComparativa,s.isConfirmed&&p&&t&&(this.abrirModalContenedorRecargar=!this.abrirModalContenedorRecargar)})},irVentaCliente(){this.step=2},irANotas(){this.step=4,this.editableStep4=!0}},computed:{...Object(P["c"])(["itemsShipment"])},watch:{step(){this.$store.state.pricing.step=this.step}}},w=b,y=(e("017d"),e("2877")),E=Object(y["a"])(w,g,h,!1,null,"66e77e22",null);s["default"]=E.exports},baf4:function(t,s,e){}}]);